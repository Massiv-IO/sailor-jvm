group 'io.elastic'
version '0.0.1-SNAPSHOT'
apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'eclipse'
apply plugin: 'groovy'

sourceCompatibility = 1.6
targetCompatibility = 1.6

repositories {
    maven {
        url "https://oss.sonatype.org/content/repositories/snapshots"
    }
    mavenLocal()
    mavenCentral()
    flatDir {
        name "fileRepo"
        dirs "lib"
    }
}

task bundle(type: Copy, dependsOn: build) {
    into "lib"
    from configurations.compile
}

dependencies {
    compile "com.google.code.gson:gson:2.2.4"
    compile "io.elastic:java-api:0.0.6"
    compile "com.rabbitmq:amqp-client:3.5.1"
    compile "commons-codec:commons-codec:1.10"
    compile "org.apache.httpcomponents:httpclient:4.3.5"

    testRuntime 'org.codehaus.groovy:groovy-all:2.0.5'
    testCompile "org.spockframework:spock-core:0.7-groovy-2.0"
    testCompile 'org.eclipse.jetty:jetty-server:8.1.9.v20130131'
    testCompile 'org.eclipse.jetty:jetty-servlet:8.1.9.v20130131'
    testCompile 'org.apache.commons:commons-io:1.3.2'
    testCompile group: 'junit', name: 'junit', version: '4.11'

}

uploadArchives {
    repositories {
        add project.repositories.fileRepo
    }
}
task elastic(dependsOn: ['clean', 'build', 'bundle', 'uploadArchives'])

task wrapper(type: Wrapper) {
	gradleVersion = '2.0'
}

build.mustRunAfter 'clean'
uploadArchives.mustRunAfter 'build'
bundle.mustRunAfter 'build'

//sourceSets.test.groovy.srcDirs = ["src/test/groovy", "src/test/java"]
//sourceSets.main.java.srcDirs = ["src/main/java"]
